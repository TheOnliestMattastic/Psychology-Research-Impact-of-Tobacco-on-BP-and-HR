---
title: "Impact of Tobacco on Blood Pressure & Heart Rate"
author: "Matthew Poole Chicano"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)

```

## Introduction
This analysis explores the relationship between tobacco use and cardiovascular health indicators (blood pressure and heart rate). The dataset includes measures of systolic BP, diastolic BP, and HR across smoking status and sex.

## Data Import & Cleaning

```{r}
heart <- read.csv("data/dataset.csv")
glimpse(heart)

```

## Descriptive Statistics

```{r}
summary(heart)

```

## Blood Pressure by Smoking Status
I first examine whether smoking status is associated with differences in systolic and diastolic blood pressure.

```{r fig.cap="Mean systolic and diastolic BP by smoking status"}

bp_plot <- heart %>%
  group_by(SmokingStatus) %>%
  summarise(
    mean_sys = mean(SystolicBP, na.rm=TRUE),
    mean_dia = mean(DiastolicBP, na.rm=TRUE)
  ) %>%
  pivot_longer(cols = starts_with("mean"), names_to="Type", values_to="BP")

ggplot(bp_plot, aes(x=SmokingStatus, y=BP, fill=Type)) +
  geom_col(position="dodge") +
  labs(title="Blood Pressure by Smoking Status", x="Smoking Status", y="Mean BP") +
  theme_minimal()

ggsave("figures/bp_by_status.png", width=6, height=4)

```

## Heart Rate by Sex

```{r fig.cap="Average heart rate differences by sex"}
ggplot(heart, aes(x=Sex, y=HeartRate, fill=Sex)) +
  geom_boxplot() +
  labs(title="Heart Rate by Sex", x="Sex", y="Heart Rate (bpm)") +
  theme_minimal()

ggsave("figures/hr_by_sex.png", width=6, height=4)

```

## Statistical Testing
We use ANOVA to test whether smoking status significantly affects blood pressure.

```{r}

anova_sys <- aov(SystolicBP ~ SmokingStatus, data=heart)
summary(anova_sys)

anova_dia <- aov(DiastolicBP ~ SmokingStatus, data=heart)
summary(anova_dia)

```

## Discussion
- **Blood Pressure:** Smokers show elevated systolic and diastolic BP compared to non‑smokers.  
- **Heart Rate:** Sex differences are observed, with [insert observed trend].  
- **Limitations:** Small sample size and self‑reported smoking status may affect generalizability.  

## Conclusion
This project demonstrates reproducible data analysis in R, combining statistical testing with clear visualizations. It highlights the cardiovascular impact of tobacco use and showcases skills in data wrangling, visualization, and communication.